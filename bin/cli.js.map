{"version":3,"file":"cli.js","sources":["../cli/call-command.ts","../cli/copy-extrance.ts","../cli/ensure-dir.ts","../cli/find-command.ts","../cli/source-dest-files.ts","../cli/start.ts","../cli/console-hello.ts","../cli/index.ts","../cli/parse-args.ts","../cli/showhelp.ts"],"sourcesContent":["import { spawn } from \"child_process\";\r\nimport process from \"process\";\r\n/**\r\n *\r\n * @param {string} command\r\n * @param { string[]} commandargs\r\n */\r\n\r\nfunction 执行命令(\r\n    /* commandstring,  */ command: string,\r\n    commandargs: string[]\r\n) {\r\n    // console.log(commandstring);\r\n    console.log(\"\\n\");\r\n    console.log([command, ...commandargs]);\r\n    const runobj = spawn(command, commandargs, {\r\n        stdio: [\"pipe\", \"pipe\", \"pipe\"],\r\n    });\r\n    runobj.stdout.on(\"data\", (data) => {\r\n        console.log(\r\n            ` ${data}`\r\n                .split(\"\\n\")\r\n                .filter((t) => t !== \"\")\r\n                .join(\"\\n\\n\")\r\n        );\r\n        console.log(\"\\n\");\r\n    });\r\n    runobj.stderr.on(\"data\", (data) => {\r\n        console.error(\r\n            ` ${data}`\r\n                .split(\"\\n\")\r\n                .filter((t) => t !== \"\")\r\n                .join(\"\\n\\n\")\r\n        );\r\n        console.log(\"\\n\");\r\n    });\r\n    runobj.on(\"close\", (code) => {\r\n        console.log(`child process exited with code ${code}`);\r\n        process.exit(code || 0);\r\n    });\r\n}\r\nexport default 执行命令;\r\n","import fs from \"fs\";\r\nimport path from \"path\";\r\nimport process from \"process\";\r\nimport 判断并创建目录 from \"./ensure-dir\";\r\nconst pwddir = process.cwd();\r\n/**\r\n * @param {(import(\"fs\").PathLike)[]} sourcefiles\r\n * @param {string[]} destfiles\r\n */\r\nexport default function 生成入口文件(\r\n    sourcefiles: string[],\r\n    destfiles: string[]\r\n) {\r\n    /**\r\n     * @param {import(\"fs\").PathLike} p\r\n     * @param {number} i\r\n     *\r\n     */\r\n    destfiles.forEach((p, i) => {\r\n        if (!fs.existsSync(p)) {\r\n            console.log(`inputfile  not exsited! ${p}\\n`);\r\n            console.log(`initialize inputfile from ${sourcefiles[i]}\\n`);\r\n            [\"public\", \"src\"]\r\n                .map((t) => path.resolve(pwddir, t))\r\n                .forEach((e) => 判断并创建目录(e));\r\n            fs.copyFileSync(sourcefiles[i], p);\r\n        }\r\n    });\r\n}\r\n","/**\r\n * @param {import(\"fs\").PathLike} p\r\n */\r\nexport default function 判断并创建目录(p: fs.PathLike) {\r\n    if (!fs.existsSync(p)) {\r\n        console.log(\"所需的目录不存在,创建目录\", p);\r\n        console.log(\"\\n\");\r\n        fs.mkdirSync(p);\r\n    }\r\n}\r\nimport fs from \"fs\";\r\n","/**\r\n * @param {string} t\r\n */\r\nexport function commandfind(t: string) {\r\n    return path.join(\r\n        __dirname,\r\n        \"../\",\r\n        \"node_modules\",\r\n        \".bin\",\r\n        t.trim() + (process.platform === \"win32\" ? \".cmd\" : \"\")\r\n    );\r\n}\r\nimport path from \"path\";\r\nimport process from \"process\";\r\n","import path from \"path\";\r\nimport process from \"process\";\r\n// const fs = require(\"fs\");\r\nconst pwddir = process.cwd();\r\n\r\nconst inputfiles = [\"public/index.html\", \"src/index.js\", \"public/favicon.ico\"];\r\nconst sourcefiles = inputfiles.map((p) =>\r\n    path.resolve(__dirname, \"../\", \"release\", p)\r\n);\r\nconst destfiles = inputfiles.map((p) => path.resolve(pwddir, p));\r\n\r\nexport { sourcefiles, destfiles };\r\n","import fs from \"fs\";\r\nimport path from \"path\";\r\nimport process from \"process\";\r\nimport 执行命令 from \"./call-command\";\r\nimport 生成入口文件 from \"./copy-extrance\";\r\nimport { commandfind } from \"./find-command\";\r\nimport { showhelp } from \"./showhelp\";\r\nimport { destfiles, sourcefiles } from \"./source-dest-files\";\r\nconst webpackcmd = \"webpack\";\r\nexport function start(\r\n    operation: string | undefined,\r\n    参数object: Record<string, string>\r\n) {\r\n    const 解析参数config = 参数object[\"config\"];\r\n    const defaultwebpackconfig = require.resolve(\r\n        path.resolve(__dirname, \"../\", \"./release/config/webpack.config.js\")\r\n    );\r\n    const 参数webpackconfigfile = 解析参数config\r\n        ? path.resolve(解析参数config)\r\n        : defaultwebpackconfig;\r\n    Reflect.set(参数object, \"config\", 参数webpackconfigfile);\r\n    const mode = 参数object[\"mode\"];\r\n    if (\"start\" === operation || \"development\" === mode) {\r\n        let command: string, commandargs: string[];\r\n        process.env.NODE_ENV = \"development\";\r\n        Reflect.set(参数object, \"mode\", process.env.NODE_ENV);\r\n\r\n        生成入口文件(sourcefiles, destfiles);\r\n        command = commandfind(webpackcmd);\r\n        commandargs = [\"serve\"];\r\n        changecmdnpx(command, commandargs, (cmd: string) => {\r\n            command = cmd;\r\n        });\r\n        addparamstocmdargs(参数object, commandargs);\r\n        console.log(\"\\n\");\r\n        console.log(`开发模式 启动 webpack-dev-server`);\r\n        console.log(\"\\n\");\r\n        执行命令(command, commandargs);\r\n    } else if (\"build\" === operation || \"production\" === mode) {\r\n        let command: string, commandargs: string[];\r\n        console.log(\"\\n\");\r\n        console.log(`生产模式 启动 webpack`);\r\n        console.log(\"\\n\");\r\n        process.env.NODE_ENV = \"production\";\r\n        Reflect.set(参数object, \"mode\", process.env.NODE_ENV);\r\n        生成入口文件(sourcefiles, destfiles);\r\n        command = commandfind(webpackcmd);\r\n        commandargs = [\"build\"];\r\n        changecmdnpx(command, commandargs, (cmd: string) => {\r\n            command = cmd;\r\n        });\r\n\r\n        addparamstocmdargs(参数object, commandargs);\r\n        执行命令(command, commandargs);\r\n    } else {\r\n        showhelp();\r\n    }\r\n}\r\n\r\nfunction addparamstocmdargs(参数object: object, commandargs: string[]) {\r\n    Object.entries(参数object).forEach(([key, value]) => {\r\n        commandargs.push(`--${key}=${value}`);\r\n    });\r\n}\r\n\r\nfunction changecmdnpx(\r\n    command: fs.PathLike,\r\n    commandargs: string[],\r\n    setcmd: { (cmd: string): void }\r\n) {\r\n    if (!fs.existsSync(command)) {\r\n        commandargs.unshift(webpackcmd);\r\n        setcmd(\"npx\" + (process.platform === \"win32\" ? \".cmd\" : \"\"));\r\n    }\r\n}\r\n","export function consolehello() {\r\n    console.log(\"\\n\");\r\n    console.log(\"webpack-react-vue-spa-awesome-config\");\r\n    console.log(\"\\n\");\r\n    console.log(\r\n        `极速、零配置的 web 应用打包工具, 同时支持 react 和 vue 的单页面应用,提供开箱即用支持,基于webpack `\r\n    );\r\n    console.log(\"\\n\");\r\n    console.log(\r\n        \"Fast, zero-configuration web application packaging tool that supports both single-page applications for react and vue, out-of-the-box support\"\r\n    );\r\n    console.log(\"\\n\");\r\n    console.log(`\\nworking directory : ${process.cwd()}\\n`);\r\n    console.log(`\\ncommand filename : ${__filename}\\n`);\r\n}\r\nimport process from \"process\";\r\n","// #!/usr/bin/env node\r\n\"use strict\";\r\nimport process from \"process\";\r\nimport { consolehello } from \"./console-hello\";\r\n// import 判断并创建目录 from \"./ensure-dir\";\r\nimport { parseargs } from \"./parse-args\";\r\nimport { start } from \"./start\";\r\n\r\nconsolehello();\r\n// console.log(\"输入的参数:\");\r\n// console.log(JSON.stringify(process.argv, null, 4));\r\nconst inargs = process.argv.slice(2);\r\nconsole.log(\"接收的参数\", inargs);\r\nconst operation = inargs.includes(\"start\")\r\n    ? \"start\"\r\n    : inargs.includes(\"build\")\r\n    ? \"build\"\r\n    : undefined;\r\nconst 参数object = parseargs(inargs);\r\nconsole.log(\"解析的参数:\");\r\nconsole.log(JSON.stringify(参数object, null, 4));\r\n\r\nstart(operation, 参数object);\r\n","/**\r\n * @param {string[]} args\r\n * @returns{Record<string,string>}\r\n */\r\nfunction parseargs(args: string[]): Record<string, string> {\r\n    /**@type{Record<string,string>} */\r\n    const 参数obj: Record<string, string> = {};\r\n    args.filter((s) => s.startsWith(\"--\"))\r\n        .map((s) => /--(?<key>.+?)=(?<value>.+)/g.exec(s))\r\n        .forEach((execArray) => {\r\n            var _a, _b, _c;\r\n            const groups =\r\n                (_a = execArray) === null || _a === void 0 ? void 0 : _a.groups;\r\n            const key =\r\n                (_b = groups) === null || _b === void 0 ? void 0 : _b.key;\r\n            const value =\r\n                (_c = groups) === null || _c === void 0 ? void 0 : _c.value;\r\n            if (key && value) {\r\n                参数obj[key] = value;\r\n            }\r\n        });\r\n    return 参数obj;\r\n}\r\nexport { parseargs };\r\n","import process from \"process\";\r\n\r\nexport function showhelp() {\r\n    console.log(\"\\n\");\r\n    console.log(\"usage:\");\r\n    console.log(\"\\n\");\r\n    console.log(`开发模式\\n启动 webpack-dev-server`);\r\n    console.log(\"\\n\");\r\n    console.log(\r\n        \"webpack-react-vue-spa-awesome-config start --mode=development\"\r\n    );\r\n    console.log(\"\\n\");\r\n    console.log(`生产模式\\n启动 webpack`);\r\n    console.log(\"\\n\");\r\n    console.log(\"webpack-react-vue-spa-awesome-config build --mode=production\");\r\n    console.log(\"\\n\");\r\n    process.exit(1);\r\n}\r\n"],"names":["执行命令","command","commandargs","console","log","runobj","spawn","stdio","stdout","on","data","split","filter","t","join","stderr","error","code","process","exit","pwddir","cwd","生成入口文件","sourcefiles","destfiles","forEach","p","i","fs","existsSync","map","path","resolve","e","mkdirSync","判断并创建目录","copyFileSync","commandfind","__dirname","trim","platform","inputfiles","addparamstocmdargs","参数object","Object","entries","key","value","push","changecmdnpx","setcmd","unshift","__filename","inargs","argv","slice","参数obj","operation","includes","undefined","s","startsWith","exec","execArray","_a","_b","_c","groups","JSON","stringify","解析参数config","defaultwebpackconfig","require","参数webpackconfigfile","Reflect","set","mode","env","NODE_ENV","cmd","start"],"mappings":"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"}